# Template Structure

This document describes the current template organization. **You are empowered to refine and redesign this structure** based on best practices to optimize backend generation from frontend JSON input.

## Current Directory Layout

```
backend/templates/
├── {vendor}/
│   └── {firmware}/
│       └── *.j2
```

**Reference implementations:**
- `cisco/nxos/` — Cisco NXOS
- `dellemc/os10/` — Dell OS10

## Your Role as Architect

When working with templates:
- **Evaluate current structure** — Is it optimal for the frontend→backend flow?
- **Recommend improvements** — Suggest better organization if you see it
- **Refactor freely** — Restructure templates to improve maintainability
- **Optimize for generation** — Templates should map cleanly to JSON input schema

> **Mindset:** The current structure is a starting point. If a different approach generates configs more cleanly from frontend input, propose and implement it.

## Naming Conventions

| Element | Convention | Example |
|---------|------------|---------|
| Vendor folder | lowercase, no spaces | `juniper`, `arista` |
| Firmware folder | lowercase | `junos`, `eos` |
| Template files | lowercase, `.j2` extension | `vlan.j2` |

## Common Templates (Current Examples)

| File | Purpose | When Used |
|------|---------|----------|
| `system.j2` | Hostname, users, management | Usually |
| `vlan.j2` | VLAN definitions and L3 interfaces | Usually |
| `interface.j2` | Physical port configurations | Usually |
| `port_channel.j2` | LAG/Port-channel/LACP | If MLAG |
| `mlag.j2` | VPC/MLAG domain config | If MLAG |
| `bgp.j2` | BGP routing configuration | If L3 |
| `qos.j2` | DCB, PFC, ETS settings | If RDMA |
| `full_config.j2` | Master template | Recommended |

## Design Principles

- **Frontend JSON → Backend templates** — Structure should mirror the JSON schema for clean mapping
- **Vendor-driven** — Different vendors may warrant different organization
- **Feature-driven** — Create templates for features the config actually uses
- **Combine or split** — Optimize for readability and generation logic
- **Challenge current patterns** — If existing structure is suboptimal, improve it

## JSON Context Variables

Templates receive the full JSON input. Common variables:

```jinja2
{{ switch.hostname }}
{{ switch.vendor }}
{{ switch.model }}
{{ switch.role }}

{% for vlan in vlans %}
  {{ vlan.vlan_id }}
  {{ vlan.name }}
{% endfor %}

{% for intf in interfaces %}
  {{ intf.name }}
  {{ intf.type }}
{% endfor %}

{{ bgp.asn }}
{{ bgp.router_id }}
```

## Full Config Template Pattern

```jinja2
{# full_config.j2 - Master template #}
!
! Configuration for {{ switch.hostname }}
! Generated by Azure Local Physical Network Config Tool
!
{% include 'system.j2' %}

{% include 'vlan.j2' %}

{% include 'interface.j2' %}

{% if port_channels is defined %}
{% include 'port_channel.j2' %}
{% endif %}

{% if bgp is defined %}
{% include 'bgp.j2' %}
{% endif %}
```
